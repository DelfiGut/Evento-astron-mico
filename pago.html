<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pago - Noche de Estrellas</title>
  <link rel="stylesheet" href="estilos.css" />
</head>
<body>

<div class="container">
  <section class="section">
    <h2>Datos personales</h2>
    <form id="form-datos">
      <label for="nombre">Nombre completo:</label>
      <input type="text" id="nombre" required>
      
      <label for="email">Correo electrónico:</label>
      <input type="email" id="email" required>
      
      <label for="direccion">Dirección:</label>
      <input type="text" id="direccion" required>
    </form>
  </section>

  <section class="section">
    <h2>Datos de pago</h2>
    <form id="form-pago">
      <label for="metodo">Método de pago:</label>
      <select id="metodo" required>
        <option value="credito">Tarjeta de crédito</option>
        <option value="debito">Tarjeta de débito</option>
        <option value="mp">Mercado Pago</option>
      </select>

      <label for="tarjeta">Número de tarjeta:</label>
      <input type="text" id="tarjeta" required>

      <label for="vencimiento">Fecha de vencimiento:</label>
      <input type="month" id="vencimiento" required>

      <label for="cvv">CVV:</label>
      <input type="text" id="cvv" maxlength="3" required>

      <button type="submit" class="btn-confirmar">Confirmar pedido</button>
    </form>
  </section>

  <section class="section oculto" id="confirmacion">
    <h2>¡Gracias por tu compra!</h2>
    <p>Tu pedido ha sido registrado y se ha enviado una confirmación por correo.</p>
  </section>

  <section class="section" id="historial-compras">
    <h2>Historial de compras</h2>
    <div id="contenedor-historial" class="ordenes"></div>
  </section>

  <div class="section" style="text-align: center;">
    <a href="index.html" class="btn-confirmar">← Volver al inicio</a>
  </div>
</div>

<script>
  document.getElementById("form-pago").addEventListener("submit", function (e) {
    e.preventDefault();

    const producto = "Producto desde pago.html";
    const total = "$5000";

    const nuevaCompra = {
      producto,
      fecha: new Date().toLocaleDateString(),
      total
    };

    const historial = JSON.parse(localStorage.getItem("historialCompras")) || [];
    historial.push(nuevaCompra);
    localStorage.setItem("historialCompras", JSON.stringify(historial));

    document.getElementById("confirmacion").classList.remove("oculto");
    mostrarHistorial();
  });

  function mostrarHistorial() {
    const historial = JSON.parse(localStorage.getItem("historialCompras")) || [];
    const contenedor = document.getElementById("contenedor-historial");

    if (historial.length === 0) {
      contenedor.innerHTML = '<p>No hay compras registradas todavía.</p>';
    } else {
      contenedor.innerHTML = historial.map((orden, i) => `
        <div class="orden">
          <h3>Orden #${i + 1}</h3>
          <p><strong>Producto:</strong> ${orden.producto}</p>
          <p><strong>Fecha:</strong> ${orden.fecha}</p>
          <p><strong>Total:</strong> ${orden.total}</p>
        </div>
      `).join('');
    }
  }

  window.onload = mostrarHistorial;
</script>

</body>
</html>
